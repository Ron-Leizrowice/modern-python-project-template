# =============================================================================
# RUFF CONFIGURATION - Python Linter & Formatter
# Docs: https://docs.astral.sh/ruff/
# Rules reference: https://docs.astral.sh/ruff/rules/
# =============================================================================

# -----------------------------------------------------------------------------
# GLOBAL SETTINGS
# -----------------------------------------------------------------------------

# Target Python version for compatibility checks and syntax upgrades.
target-version = "py314"
# Directory to store cache files (I prefer not having `.ruff_cache` in the root directory)
cache-dir = ".cache/ruff"
# When true, Ruff will not lint/format files ignored by .gitignore.
respect-gitignore = true
# Exclude Jupyter notebooks (I assume they're just for testing and not part of the production code)
extend-exclude = ["**.ipynb"]
# Maximum line length for formatting (its 2026, our monitors are pretty big, we can spare the pixels)
line-length = 120
# Number of spaces per indentation level (used by formatter).
indent-width = 4

# -----------------------------------------------------------------------------
# FORMATTER SETTINGS
# -----------------------------------------------------------------------------
[format]
# The space vs tab wars will never end, but I find spaces to cause fewer issues, and its default for black and ruff
indent-style = "space"
# I prefer double quotes for consistency, to avoid escaping issues, and to avoid confusion with apostrophes
quote-style = "double"
# Auto-detect the appropriate line ending for the platform
line-ending = "auto"
# Skip magic trailing comma: allows you to break lists over multiple lines (just add a comma at the end)
skip-magic-trailing-comma = false

# -----------------------------------------------------------------------------
# LINTER SETTINGS
# -----------------------------------------------------------------------------
[lint]
select = [
  "ERA",    # [Disallow commented-out code](https://docs.astral.sh/ruff/rules/#eradicate-era)
  "YTT",    # [Ensure correct usage of `sys.version`](https://docs.astral.sh/ruff/rules/#flake8-2020-ytt)
  "ANN",    # [Enforces PEP 3107 â€“ Function Annotations](https://docs.astral.sh/ruff/rules/#flake8-annotations-ann)
  "ASYNC",  # [Opinionated rules regarding Trio/AnyIO/asyncio](https://docs.astral.sh/ruff/rules/#flake8-async-async)
  "FBT",    # [Catches "boolean trap" issues](https://docs.astral.sh/ruff/rules/#flake8-bandit-s)
  "B",      # [Bugbear opinionated linting rules](https://docs.astral.sh/ruff/rules/#flake8-bugbear-b)
  "A",      # [Check for python builtins being used as variables or parameters.](https://docs.astral.sh/ruff/rules/#flake8-builtins-a)
  "COM",    # [Opinionated rules regarding trailing commas](https://docs.astral.sh/ruff/rules/#flake8-commas-com)
  "C4",     # [Opinionated rules regarding comprehensions](https://docs.astral.sh/ruff/rules/#flake8-comprehensions-c4)
  "DTZ",    # [Bans usage of unsafe naive datetime class](https://docs.astral.sh/ruff/rules/#flake8-datetimez-dtz)
  "FA",     # [Ensures usage of `__future__` imports](https://docs.astral.sh/ruff/rules/#flake8-future-imports-fa)
  "ISC",    # [Rules regarding implicit string concatenation](https://docs.astral.sh/ruff/rules/#flake8-implicit-str-concat-isc)
  "ICN",    # [Opinionated rules regarding import conventions](https://docs.astral.sh/ruff/rules/#flake8-import-conventions-icn)
  "LOG",    # [Opinionated rules regarding logging](https://docs.astral.sh/ruff/rules/#flake8-logging-format-log)
  "INP",    # [Requires `__init__.py` files to be present](https://docs.astral.sh/ruff/rules/#flake8-no-pep420-inp)
  "PIE",    # [Misc flake8 lints](https://docs.astral.sh/ruff/rules/#flake8-pie-pie)
  "PYI",    # [Opinionated rules regarding type annotations](https://docs.astral.sh/ruff/rules/#flake8-pyi-pyi)
  "PT",     # [Pytest style rules](https://docs.astral.sh/ruff/rules/#flake8-pytest-pt)
  "Q",      # [Opinionated rules regarding quotes](https://docs.astral.sh/ruff/rules/#flake8-quotes-q)
  "RET",    # [Opinionated rules regarding return statements](https://docs.astral.sh/ruff/rules/#flake8-returning-ret)
  "SLF",    # [Detects private member access](https://docs.astral.sh/ruff/rules/#flake8-self-slf)
  "SIM",    # [Rules to simplify code](https://docs.astral.sh/ruff/rules/#flake8-simplify-sim)
  "SLOT",   # [Opinionated rules regarding `__slots__`](https://docs.astral.sh/ruff/rules/#flake8-slots-slot)
  "TID",    # [Rules for tidy imports](https://docs.astral.sh/ruff/rules/#flake8-tidy-imports-tid)
  "ARG",    # [Detects unused function arguments](https://docs.astral.sh/ruff/rules/#flake8-unused-arguments-arg)
  "PTH",    # [Enforces uses of pathlib](https://docs.astral.sh/ruff/rules/#flake8-use-pathlib-pth)
  "I",      # [Import sorting](https://docs.astral.sh/ruff/rules/#isort-i)
  "N",      # [Naming convention rules](https://docs.astral.sh/ruff/rules/#pep8-naming-n)
  "PERF",   # [Performance related linting rules](https://docs.astral.sh/ruff/rules/#flake8-performance-perf)
  "E",      # [Pycodestyle Errors](https://docs.astral.sh/ruff/rules/#pycodestyle-e)
  "W",      # [Pycodestyle Warnings](https://docs.astral.sh/ruff/rules/#pycodestyle-w)
  "D",      # [Docstring linting rules](https://docs.astral.sh/ruff/rules/#pydocstyle-d)
  "F",      # [Pyflakes linting rules](https://docs.astral.sh/ruff/rules/#pyflakes-f)
  "PL",     # [Type checking linting rules](https://docs.astral.sh/ruff/rules/#mypy-pl)
  "UP",     # [Automatically upgrades syntax to newer python versions](https://docs.astral.sh/ruff/rules/#pyupgrade-up)
  "FURB",   # [Modernization rules](https://docs.astral.sh/ruff/rules/#flake8-future-furb)
  "RUF",    # [Ruff specific linting rules](https://docs.astral.sh/ruff/rules/#ruff-ruff)
  "FAST",   # [FastAPI specific linting rules](https://docs.astral.sh/ruff/rules/#flake8-fastapi-fast)
  "DJ",     # [Django specific linting rules](https://docs.astral.sh/ruff/rules/#flake8-django-dj)
  "NPY",    # [NumPy specific linting rules](https://docs.astral.sh/ruff/rules/#flake8-numpy-npy)
  "PD",     # [Pandas specific linting rules](https://docs.astral.sh/ruff/rules/#flake8-pandas-pd)

  # Optional
  # "S",      # [Opinionated rules from Bandit regarding security](https://docs.astral.sh/ruff/rules/#flake8-bandit-s)
]
ignore = [
  "COM812",   # Disabled for compatibility with ruff formatter
  "D202",     # Allow blank lines after function docstrings
  "D203",     # Do not insert an extra linebreak for class docstrings
  "D213",     # We want docstrings to start on the first line, not the second.
  "N815",     # Allow camelCase attributes (useful for creating pydantic models)
  "S101",     # Allow use of assert statements (unless you are actually using `-O` to optimize your code)
  "SIM108",   # Allow if/else blocks (instead of requiring ternary operations)
]

[lint.per-file-ignores]
"tests/*" = [ 
  "ANN201",   # Tests usually return None anyway, we don't need to annotate them
  "D103",     # Tests probably don't need docstrings
  "INP001",   # Tests are not part of the package and don't need __init__.py files
  "PLC0415",  # Lazy imports are fine in tests, and useful to speed up test collection
]
